{% extends "base.html" %}
{% block content %}

<h2>ìš”ì•½ ìƒì„¸ë³´ê¸°</h2>

<div class="summary-detail">
  <div class="summary-date">
    {{ summary.created_at.strftime("%Y-%m-%d %H:%M") }}
  </div>

  <h3>ìš”ì•½ ê²°ê³¼</h3>
  <p id="summary-text">{{ summary.summary }}</p>

  <button id="copy-btn">ğŸ“‹ ë³µì‚¬í•˜ê¸°</button>
  <hr>

  <h3>ì›ë¬¸ ì „ì²´</h3>
  <div id="original-text" style="display: none; white-space: pre-wrap;">{{ summary.text }}</div>
  <button id="toggle-btn">ğŸ‘ ì›ë¬¸ ë³´ê¸°</button>

  <hr>
  <button id="delete-btn" style="background-color:#dc3545;">ğŸ—‘ ì‚­ì œí•˜ê¸°</button>
  <a href="/history">â† ëª©ë¡ìœ¼ë¡œ</a>
</div>

<script>
  // ì›ë¬¸ ë³´ê¸° / ìˆ¨ê¸°ê¸°
  document.getElementById("toggle-btn").addEventListener("click", function() {
    const original = document.getElementById("original-text");
    if (original.style.display === "none") {
      original.style.display = "block";
      this.textContent = "ğŸ‘ ìˆ¨ê¸°ê¸°";
    } else {
      original.style.display = "none";
      this.textContent = "ğŸ‘ ì›ë¬¸ ë³´ê¸°";
    }
  });

  // ìš”ì•½ ë³µì‚¬
  document.getElementById("copy-btn").addEventListener("click", function() {
    const text = document.getElementById("summary-text").innerText;
    navigator.clipboard.writeText(text).then(() => {
      alert("ìš”ì•½ì´ ë³µì‚¬ë˜ì—ˆìŠµë‹ˆë‹¤!");
    });
  });

  // ì‚­ì œ ê¸°ëŠ¥
  document.getElementById("delete-btn").addEventListener("click", function() {
    if (confirm("ì •ë§ ì‚­ì œí•˜ì‹œê² ìŠµë‹ˆê¹Œ?")) {
      fetch("/delete/{{ summary.id }}", { method: "POST" })
        .then(res => res.json())
        .then(data => {
          if (data.success) {
            alert("ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.");
            window.location.href = "/history";
          } else {
            alert("ì‚­ì œ ì‹¤íŒ¨. ë‹¤ì‹œ ì‹œë„í•´ ì£¼ì„¸ìš”.");
          }
        });
    }
  });
</script>

{% endblock %}
